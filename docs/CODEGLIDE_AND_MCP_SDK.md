# CodeGlide & MCP SDK Guide

## Overview

This project uses **two different but complementary SDKs**:

1. **CodeGlide Platform** - Generates MCP servers
2. **MCP SDK** (`@modelcontextprotocol/sdk`) - Connects to MCP servers

Let me explain both:

---

## 🎨 CodeGlide Platform (Server Generation)

CodeGlide is a **platform** (not an SDK you install) that generates MCP servers from API specifications.

### How It Works

```
┌─────────────────────────────────────────────────────────────┐
│                   CodeGlide Platform                         │
│                   (go.codeglide.ai)                         │
│                                                             │
│  1. Upload API Specification (OpenAPI, Swagger)             │
│  2. Configure generation options                            │
│  3. Generate MCP server code                                │
│  4. Download or deploy to artifactory                       │
└─────────────────────────────────────────────────────────────┘
```

### Installation Options

#### Option 1: VS Code Extension
```bash
# Install from VS Code Marketplace
code --install-extension Opsera.CodeGlide-mcp-server-generator
```

#### Option 2: Command Palette (in VS Code/Cursor)
1. Press `Ctrl/Cmd + Shift + P`
2. Type "Generate MCP Server"
3. Select your API source
4. Choose target language (Go, Java, JavaScript, Python)

#### Option 3: Web Platform
Visit https://go.codeglide.ai/ and use the web interface

### Generation Process

```typescript
// What CodeGlide does internally (conceptual):

// 1. Parse API Specification
const apiSpec = parseOpenAPI('slack-api.yaml');

// 2. Extract endpoints
const endpoints = [
  { path: '/conversations.history', method: 'GET', ... },
  { path: '/chat.postMessage', method: 'POST', ... },
];

// 3. Generate MCP tools
endpoints.forEach(endpoint => {
  generateMCPTool({
    name: endpoint.path.replace('/', '.'),
    description: endpoint.description,
    parameters: endpoint.parameters,
    handler: generateAPIHandler(endpoint)
  });
});

// 4. Package as MCP server
createMCPServer({
  name: 'slack-mcp-server',
  tools: generatedTools,
  language: 'javascript'
});
```

### Output Structure

After generation, CodeGlide creates:

```
slack_web/                      # Generated by CodeGlide
├── bin/
│   └── slack-mcp.js           # Executable entry point
├── src/
│   ├── index.ts               # MCP server setup
│   ├── server.ts              # Request handlers
│   └── tools/
│       ├── conversations.ts   # Slack conversations API
│       ├── chat.ts            # Slack chat API
│       └── users.ts           # Slack users API
├── package.json
├── tsconfig.json
└── README.md
```

---

## 📦 MCP SDK (`@modelcontextprotocol/sdk`)

This is the **actual SDK** installed in your project that **connects to** MCP servers.

### Installation

```bash
npm install @modelcontextprotocol/sdk
```

### What's in the SDK

The MCP SDK provides two main components:

#### 1. **Client** (What You Use)
```typescript
import { Client } from '@modelcontextprotocol/sdk/client/index.js';
import { StdioClientTransport } from '@modelcontextprotocol/sdk/client/stdio.js';

// Create a client
const client = new Client({
  name: 'my-app',
  version: '1.0.0'
}, {
  capabilities: {
    tools: {}  // Request tool calling capability
  }
});

// Connect to MCP server via stdio
const transport = new StdioClientTransport({
  reader: serverProcess.stdout,
  writer: serverProcess.stdin
});

await client.connect(transport);

// Call tools
const result = await client.callTool({
  name: 'conversations.history',
  arguments: { channel: 'C123', limit: 10 }
});
```

#### 2. **Server** (What CodeGlide Generates)
```typescript
import { Server } from '@modelcontextprotocol/sdk/server/index.js';
import { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js';

// Create a server
const server = new Server({
  name: 'slack-mcp-server',
  version: '1.0.0'
}, {
  capabilities: {
    tools: {}  // Provide tools
  }
});

// Register tools
server.setRequestHandler('tools/list', async () => ({
  tools: [
    {
      name: 'conversations.history',
      description: 'Fetch conversation history',
      inputSchema: { ... }
    }
  ]
}));

// Handle tool calls
server.setRequestHandler('tools/call', async (request) => {
  const { name, arguments: args } = request.params;
  // Execute and return result
});

// Start server
const transport = new StdioServerTransport();
await server.connect(transport);
```

---

## 🔄 How They Work Together in Your Project

```
┌─────────────────────────────────────────────────────────────┐
│ 1. CODEGLIDE GENERATES (One-time)                           │
│                                                              │
│    CodeGlide Platform → slack_web/ MCP Server               │
│                       → Notion/ MCP Server                  │
│                       → Jira_Integration_API/ MCP Server    │
│                                                              │
│    Published to: github.com/CodeGlide/mcp-artifactory       │
└─────────────────────────────────────────────────────────────┘
                            ↓
                            ↓ You clone/download
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ 2. YOUR PROJECT USES (Runtime)                              │
│                                                              │
│    Your Code (src/mcp/clients.ts)                           │
│         ↓                                                    │
│    Uses @modelcontextprotocol/sdk Client                    │
│         ↓                                                    │
│    Spawns CodeGlide-generated servers                       │
│         ↓                                                    │
│    Calls tools via MCP protocol                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 📖 MCP SDK API Reference

### Client API

```typescript
// 1. Create client
const client = new Client(
  { name: string, version: string },
  { capabilities: { tools?: {}, resources?: {}, prompts?: {} } }
);

// 2. Connect
await client.connect(transport);

// 3. List available tools
const { tools } = await client.listTools();
// Returns: [{ name, description, inputSchema }, ...]

// 4. Call a tool
const result = await client.callTool({
  name: string,
  arguments: Record<string, unknown>
});
// Returns: { content: [{ type, text }], isError?: boolean }

// 5. Close connection
await client.close();
```

### Transport Options

```typescript
// Stdio Transport (for local processes)
import { StdioClientTransport } from '@modelcontextprotocol/sdk/client/stdio.js';

const transport = new StdioClientTransport({
  reader: process.stdout,
  writer: process.stdin
});

// HTTP/SSE Transport (for remote servers)
import { SSEClientTransport } from '@modelcontextprotocol/sdk/client/sse.js';

const transport = new SSEClientTransport(
  new URL('https://api.example.com/mcp')
);
```

---

## 🎯 Your Project's Usage

### File: `src/mcp/clients.ts`

```typescript
import { Client } from '@modelcontextprotocol/sdk/client/index.js';
import { StdioClientTransport } from '@modelcontextprotocol/sdk/client/stdio.js';

export async function createMCPClient(config: MCPServerConfig) {
  // 1. Create MCP SDK client
  const client = new Client({
    name: `expense-lane-${config.name}`,
    version: '1.0.0',
  }, {
    capabilities: { tools: {} }
  });
  
  // 2. Spawn CodeGlide-generated server
  const serverProcess = spawn(config.command, config.args, {
    env: config.env,
    stdio: ['pipe', 'pipe', 'pipe']
  });
  
  // 3. Create stdio transport
  const transport = new StdioClientTransport({
    reader: serverProcess.stdout,
    writer: serverProcess.stdin
  });
  
  // 4. Connect client to server
  await client.connect(transport);
  
  return {
    client,
    async callTool(name: string, args: Record<string, unknown>) {
      return await client.callTool({ name, arguments: args });
    }
  };
}
```

### File: `src/services/slack.ts`

```typescript
export async function fetchLatestSlackMessages(
  slackClient: MCPClient,
  channelId: string
) {
  // Call tool on CodeGlide-generated Slack MCP server
  const result = await slackClient.callTool('conversations.history', {
    channel: channelId,
    limit: 10
  });
  
  // Parse result
  const data = JSON.parse(result.content[0].text);
  return data.messages;
}
```

---

## 📦 Package Dependencies

```json
{
  "dependencies": {
    "@modelcontextprotocol/sdk": "^0.5.0"  // MCP Client SDK
  }
}
```

**Note:** You don't install CodeGlide as a dependency - you use CodeGlide's **generated servers** which themselves use `@modelcontextprotocol/sdk` on the server side.

---

## 🔍 Key Differences

| Aspect | CodeGlide Platform | MCP SDK |
|--------|-------------------|---------|
| **Type** | Code generator/platform | npm package |
| **Purpose** | Generate MCP servers | Connect to MCP servers |
| **When Used** | One-time (during development) | Runtime (in your app) |
| **Installation** | VS Code extension or web | `npm install` |
| **Output** | Source code for MCP servers | Client/Server classes |
| **In Your Code** | No (uses its output) | Yes (imports from it) |

---

## 🚀 Complete Flow Example

### 1. **CodeGlide Generates Server** (Done Once)

```bash
# At CodeGlide HQ or via VS Code extension
codeglide generate \
  --api slack \
  --spec slack-openapi.yaml \
  --language javascript \
  --output slack_web/

# Result: slack_web/ directory with complete MCP server
```

### 2. **Published to Artifactory**

```bash
git clone https://github.com/CodeGlide/mcp-artifactory.git mcp-servers
cd mcp-servers/slack_web
npm install
```

### 3. **Your App Uses MCP SDK Client**

```typescript
// Your code
import { Client } from '@modelcontextprotocol/sdk/client/index.js';

// Spawn the CodeGlide-generated server
const server = spawn('node', ['mcp-servers/slack_web/bin/slack-mcp.js']);

// Connect via MCP SDK
const client = new Client(...);
await client.connect(transport);

// Call tools
await client.callTool('conversations.history', { channel: 'C123' });
```

---

## 🎓 Learning Resources

### MCP SDK Documentation
- **GitHub:** https://github.com/modelcontextprotocol/sdk
- **Spec:** https://spec.modelcontextprotocol.io/

### CodeGlide Platform
- **Website:** https://go.codeglide.ai/
- **VS Code Extension:** https://marketplace.visualstudio.com/items?itemName=Opsera.CodeGlide-mcp-server-generator
- **Artifactory:** https://github.com/CodeGlide/mcp-artifactory

---

## 💡 Summary

**CodeGlide:**
- ✅ Platform/tool that **generates** MCP servers
- ✅ Takes API specs → Outputs working server code
- ✅ You use its **output** (pre-built servers)

**MCP SDK:**
- ✅ npm package you **install** in your project
- ✅ Provides `Client` to connect to MCP servers
- ✅ You use its **Client API** to call tools

**Together:**
- CodeGlide generates the servers
- MCP SDK Client connects to those servers
- Your app orchestrates multiple MCP servers
- Complete automation achieved! 🚀

---

**In your project: You use MCP SDK Client to connect to CodeGlide-generated servers!**

